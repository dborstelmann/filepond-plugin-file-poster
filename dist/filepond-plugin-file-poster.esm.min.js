/*
 * FilePondPluginFilePoster 1.0.0
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
const getImageSize=(e,t)=>{let i=new Image;i.onload=(()=>{const e=i.naturalWidth,n=i.naturalHeight;i=null,t(e,n)}),i.src=e};var plugin$1=({addFilter:e,utils:t})=>{const{createRoute:i,Type:n,isFile:r}=t;return e("CREATE_VIEW",e=>{const{is:t,view:n,query:r}=e;if(!t("file")||!r("GET_ALLOW_IMAGE_PREVIEW"))return;n.registerWriter(i({DID_LOAD_ITEM:({root:e,props:t,actions:i})=>{const{id:n}=t,o=r("GET_ITEM",n);if(!o)return;const l=o.getMetadata("poster");if(!l)return;e.ref.poster=document.createElement("div"),e.ref.poster.className="filepond--file-poster",e.element.appendChild(e.ref.poster);const s=document.createElement("img");s.src=l,e.ref.poster.appendChild(s),getImageSize(l,(t,i)=>{e.dispatch("DID_POSTER_CALCULATE_SIZE",{id:n,width:t,height:i})})},DID_POSTER_CALCULATE_SIZE:({root:e,props:t,action:i})=>{e.query("GET_ITEM",{id:t.id});console.log("size calculated",i,e.rect.element.width);const n=i.height/i.width;e.ref.poster.style.cssText=`height:${Math.round(e.rect.element.width*n)}px`,e.element.style.cssText=`height:${Math.round(e.rect.element.width*n)}px`}}))}),{options:{allowFilePoster:[!0,n.BOOLEAN]}}};"undefined"!=typeof navigator&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;